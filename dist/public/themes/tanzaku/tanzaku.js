angular.module("quartz.theme",["quartz.config","ngRoute","infinite-scroll"]).config(["$routeProvider","routeUrls","maxPostsPerReq",function($routeProvider,routeUrls,maxPostsPerReq){return $routeProvider.when(routeUrls.HomePage,{controller:"MultiPostCtrl",resolve:{posts:function(MultiPostLoader){return MultiPostLoader({type:"Post",offset:0,limit:maxPostsPerReq,get:["id","tags","title","content","postDate","category"],moreTag:!0})},type:function(){return"Post"}},templateUrl:"multipost.html"}).when(routeUrls.Category,{controller:"MultiPostCtrl",resolve:{posts:function(MultiPostLoader){return MultiPostLoader({type:"Category",offset:0,limit:maxPostsPerReq,get:["id","tags","title","content","postDate"],moreTag:!0})},type:function(){return"Category"}},templateUrl:"multipost.html"}).when(routeUrls.Tag,{controller:"MultiPostCtrl",resolve:{posts:function(MultiPostLoader){return MultiPostLoader({type:"Tag",offset:0,limit:maxPostsPerReq,get:["id","tags","title","content","postDate"],moreTag:!0})},type:function(){return"Tag"}},templateUrl:"multipost.html"}).when(routeUrls.Single,{controller:"PostCtrl",resolve:{post:function(PostLoader){return PostLoader()}},templateUrl:"/public/themes/tanzaku/post.html"}).when(routeUrls[404],{resolve:{t:function(NotFoundLoader){return NotFoundLoader()}},controller:"NotFoundCtrl",templateUrl:"/public/themes/tanzaku/404.html"}).otherwise({redirectTo:"/404"})}]).service("redrawGrid",["$rootScope",function($rootScope){return function(){var isSinglePost,setGrid;return isSinglePost=$rootScope.meta.isSinglePost,setGrid=function(){return $("#grid-wrapper").vgrid({easeing:"easeOutQuint",time:800,delay:60,selRefGrid:"#grid-wrapper div.x1",selFitWidth:["#container","#footer"],gridDefWidth:325,forceAnim:!0})},isSinglePost&&$("#grid-wrapper").css("display","none"),$(window).load(function(){return setTimeout(function(){return $("#grid-wrapper").css("paddingTop","0px")},1e3)}),setTimeout(setGrid,300),setTimeout(function(){var anim_msec;return isSinglePost&&(anim_msec=$("#single-wrapper").height(),1e3>anim_msec&&(anim_msec=1e3),anim_msec>3e3&&(anim_msec=3e3),$("#single-wrapper").css("paddingTop","0px").hide().slideDown(anim_msec)),"hidden"===$("#header").css("visibility")?$("#header").hide().css("visibility","visible").fadeIn(500):void 0},500)}}]).controller("MultiPostCtrl",["$rootScope","Post","MultiPostLoader","redrawGrid","maxPostsPerReq","type",function($rootScope,Post,MultiPostLoader,redrawGrid,maxPostsPerReq,type){return redrawGrid(),$rootScope.LoadMore=function(){return MultiPostLoader({type:type,offset:$rootScope.lastPostOrd,limit:maxPostsPerReq,get:["id","tags","title","content","postDate"],moreTag:!0}),$rootScope.allPostsLoaded?$rootScope.LoadMore=function(){}:void 0}}]).controller("PostCtrl",["redrawGrid",function(redrawGrid){return redrawGrid()}]).controller("NotFoundCtrl",[function(){}]);